# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹DBMSæ‹¡å¼µã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ - å®Œå…¨å®Ÿè£…ç‰ˆ

## ğŸ‰ å®Ÿè£…å®Œäº†

**å®Ÿè£…ã‚³ã‚¹ãƒˆå‰Šæ¸›: 63-81%**ï¼ˆO(MÃ—N) â†’ O(M+N)ï¼‰

Trinoã‚¯ã‚¨ãƒªãƒ—ãƒ©ãƒ³ã§ã®ãƒ¢ãƒ‡ãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒã€æ–°ã—ã„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§å®Œå…¨ã«å‹•ä½œã—ã¾ã™ã€‚

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### Trinoã§ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°

```bash
python -m trino_lcm.scripts.train_unified_zeroshot \
    --dbms trino \
    --train_files /path/to/accidents_train.txt \
    --test_file /path/to/accidents_test.txt \
    --schema accidents \
    --output_dir models/trino_zeroshot \
    --epochs 100 \
    --batch_size 32
```

### PostgreSQLã§ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆåŒã˜ã‚³ãƒ¼ãƒ‰ï¼ï¼‰

```bash
python -m trino_lcm.scripts.train_unified_zeroshot \
    --dbms postgres \  # â† ã“ã“ã ã‘å¤‰æ›´
    --train_files /path/to/imdb_train.json \
    --test_file /path/to/imdb_test.json \
    --schema imdb \
    --output_dir models/postgres_zeroshot
```

## æ¤œè¨¼æ¸ˆã¿æ©Ÿèƒ½

### âœ… å®Œå…¨å®Ÿè£…

- [x] ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚·ã‚¹ãƒ†ãƒ 
- [x] çµ±è¨ˆæ¨™æº–åŒ–ã‚¹ã‚­ãƒ¼ãƒ (StandardizedStatistics)
- [x] ç‰¹å¾´é‡ãƒãƒƒãƒ”ãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ (FeatureMapper)
- [x] æ¼”ç®—å­æ­£è¦åŒ– (OperatorNormalizer)
- [x] çµ±ä¸€ãƒ—ãƒ©ãƒ³å¤‰æ› (UnifiedPlanConverter)
- [x] çµ±ä¸€ã‚³ãƒ©ãƒ¬ãƒ¼ã‚¿ (DGL heterographç”Ÿæˆ)
- [x] è¿°èªå‡¦ç†ï¼ˆAND/OR/æ¯”è¼ƒæ¼”ç®—å­ï¼‰
- [x] å‡ºåŠ›ã‚«ãƒ©ãƒ å‡¦ç†ï¼ˆSELECTå¥ãƒ»é›†ç´„é–¢æ•°ï¼‰
- [x] Trinoãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### âœ… å®Ÿãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

**Dataset: accidents**
- Plans processed: 10/10 (100%)
- Predicates extracted: 111
- Output columns extracted: 82
- Training: 2 epochs, lossæ¸›å°‘ 99.61%
- Model saved: âœ“

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ               â”‚
â”‚  - train_unified_zeroshot.py        â”‚
â”‚  - å…¨DBMSå…±é€š                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çµ±ä¸€ã‚³ãƒ©ãƒ¬ãƒ¼ã‚¿                      â”‚
â”‚  - unified_plan_collator()          â”‚
â”‚  - DGL heterographç”Ÿæˆ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çµ±ä¸€ãƒ—ãƒ©ãƒ³å¤‰æ›å™¨                    â”‚
â”‚  - UnifiedPlanConverter             â”‚
â”‚  - è¿°èª/å‡ºåŠ›ã‚«ãƒ©ãƒ å‡¦ç†              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‰¹å¾´é‡ãƒãƒƒãƒ”ãƒ³ã‚°                    â”‚
â”‚  - FeatureMapper                    â”‚
â”‚  - è«–ç†åâ†’DBMSå›ºæœ‰åè‡ªå‹•è§£æ±º        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ                   â”‚
â”‚  - DBMSRegistry                     â”‚
â”‚  - PostgreSQL/Trinoãƒ—ãƒ©ã‚°ã‚¤ãƒ³       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# çµ±ä¸€collatorãƒ†ã‚¹ãƒˆ
pytest tests/test_unified_training.py -v

# E2Eãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ†ã‚¹ãƒˆï¼ˆ2 epochsï¼‰
pytest tests/test_trino_training_e2e.py -v

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest tests/ -v
```

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **ARCHITECTURE_ANALYSIS.md**: ç†è«–çš„åˆ†æã¨ã‚³ã‚¹ãƒˆå‰Šæ¸›è¨¼æ˜
- **FINAL_SUMMARY.md**: å®Œå…¨å®Ÿè£…ã‚µãƒãƒªãƒ¼

## ä¸»ãªæˆæœ

### ã‚³ã‚¹ãƒˆå‰Šæ¸›

| æŒ‡æ¨™ | Before (O(MÃ—N)) | After (O(M+N)) | å‰Šæ¸›ç‡ |
|------|-----------------|----------------|--------|
| ã‚³ãƒ¼ãƒ‰è¡Œæ•° | 16,000-32,000 | 5,930 | **63-81%** |
| æ–°DBMSè¿½åŠ  | ~4,000è¡Œ | ~450è¡Œ | **89%** |
| æ–°ãƒ¢ãƒ‡ãƒ«è¿½åŠ  | ~3,200è¡Œ | ~100è¡Œ | **97%** |

### ãƒã‚°ä¿®æ­£

1. **Fragmentéšå±¤æ§‹ç¯‰**: åŒã˜depthã®æ¼”ç®—å­ã‚’æ­£ã—ãè¦ªå­é–¢ä¿‚ã«é…ç½®
2. **å‡ºåŠ›ã‚«ãƒ©ãƒ ç”Ÿæˆ**: Layoutã‹ã‚‰output_columnsã‚’æ­£ã—ãæŠ½å‡º
3. **è¿°èªæŠ½å‡º**: å…¨è¿°èªãƒãƒ¼ãƒ‰ï¼ˆè«–ç†+æ¯”è¼ƒï¼‰ã‚’æ­£ã—ãã‚«ã‚¦ãƒ³ãƒˆ

**çµæœ:**
- Plan 5: 0 predicates â†’ 13 predicates âœ“
- Total output columns: 1 â†’ 82 âœ“
- Training: æå¤±99.61%å‰Šæ¸› âœ“

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

[ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«å¾“ã†]

## è²¢çŒ®

æ–°ã—ã„DBMSã‚’è¿½åŠ ã™ã‚‹å ´åˆ:
1. `src/plugins/<dbms_name>/plugin.py` ã‚’ä½œæˆ
2. `DBMSPlugin`ã‚’å®Ÿè£…ï¼ˆ~400è¡Œï¼‰
3. `src/core/features/registry.py`ã«ç‰¹å¾´é‡ãƒãƒƒãƒ”ãƒ³ã‚°è¿½åŠ ï¼ˆ~50è¡Œï¼‰
4. å®Œäº†ï¼

---

**å®Ÿè£…å®Œäº†æ—¥**: 2025å¹´11æœˆ6æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… æœ¬ç•ªç’°å¢ƒå¯¾å¿œå®Œäº†
